<mat-form-field appearance="outline" class="w-100 custom-green-focus-label custom-border-focus">
  <mat-label style="font-size: var(--text-sm);">{{ label }}</mat-label>

  @if (icon) {
    <mat-icon 
      class="p-0 ps-2 border-color-input" matPrefix
    >{{ icon }}</mat-icon>
  }

  <input
    matInput
    [ngModel]="value"
    (ngModelChange)="onInput($event)"
    (blur)="onBlur(); model.control.markAsTouched()"
    [required]="required"
    [minlength]="minlength"
    [disabled]="disabled"
    [matAutocomplete]="auto"
    [placeholder]="placeholder"
    #model="ngModel"
  />

  <mat-autocomplete
    #auto="matAutocomplete"
    (optionSelected)="onSelected($event.option.value)"
    autoActiveFirstOption
  >
    @for (c of (filteredCities$ | async); track c.id) {
      <mat-option [value]="c">
        {{ c.name }}
        @if (c.state) {
          <span class="muted">· {{ c.state }}</span>
        }
        @if (c.region) {
          <span class="muted">· {{ c.region }}</span>
        }
      </mat-option>
    }
  </mat-autocomplete>

  @if (hint) {
    <mat-hint class="muted">{{ hint }}</mat-hint>
  }

  @if (model.touched && model.errors?.['required']) {
    <mat-error>Ce champ est obligatoire.</mat-error>
  }
  @if (model.touched && model.errors?.['minlength']) {
    <mat-error>Minimum {{ minlength }} caractères.</mat-error>
  }
</mat-form-field>
